
:root {
  --bg: #0b1220;
  --card: #111a2eed
  --accent: #22d3ee;
  --text: #e5e7eb;
  --muted: #7f8ea3;
}
* { box-sizing: border-box; }
    html, body {
    margin:0;
    padding:0;
    color:var(--text);
    font-family: system-ui, -apple-system, Segoe UI, Roboto, sans-serif;
}


.container {
    max-width: 95%;
    margin: 0 auto;
    padding: 16px;
    }

#topbar {
  display:flex; justify-content:space-between; align-items:center;
  padding:12px 16px; background:rgba(255,255,255,0.03); border-bottom:1px solid rgba(255,255,255,0.07);
  position: sticky; top:0; backdrop-filter: blur(6px);
}
#topbar .brand { color: var(--text); text-decoration: none; font-weight:700; }
#topbar .nav a, #topbar .nav span { color: var(--text); margin-left: 12px; text-decoration: none; }
#topbar .hello { color: var(--muted); }

.controls button {
  margin-right:8px; padding:8px 10px; background:var(--card); color:var(--text);
  border:1px solid rgba(255,255,255,0.1); border-radius:10px;
}
.controls button:hover { border-color: var(--accent); }

.grid {
  display:grid; grid-template-columns: repeat(4, 1fr); grid-auto-rows: minmax(160px, 1fr);
  gap:10px; padding:12px; margin-top: 10px; z-index: 2;
}
.cell {
  background:var(--card); border:1px solid rgba(255,255,255,0.08); border-radius:14px; overflow:hidden; position:relative;
  display:flex; flex-direction:column;
}
.cell-header {
  font-size:14px; color:var(--muted); padding:6px 10px; background:rgba(0,0,0,0.25);
  display:flex; justify-content:space-between; align-items:center;
}
.cell video {
  width:100%; height:100%; object-fit:cover; background:#000;
  flex:1; transform: scaleX(-1); z-index: 1;
}
.name { color:var(--text); font-weight:600; }
.free { opacity: 0.6; }

.form { display:flex; flex-direction:column; max-width: 360px; gap:8px; }
.form input, .form button {
  padding:10px; border-radius:10px; border:1px solid rgba(255,255,255,0.15); background:var(--card); color:var(--text);
}
.table { width:100%; border-collapse: collapse; }
.table th, .table td { border-bottom:1px solid rgba(255,255,255,0.08); padding:8px; text-align:left; }
.flash .msg { margin: 8px 0; padding:8px 10px; border-radius:8px; background: rgba(255,255,255,0.06); }
.msg.error { border: 1px solid #ef4444; }
.msg.ok { border: 1px solid #22c55e; }
.muted { color: var(--muted); }

.cell[data-slot="12"] {
  border-color: rgba(255, 221, 87, 0.6);
  box-shadow: 0 0 0 1px rgba(255, 221, 87, 0.25) inset;
}
.cell[data-slot="12"] .cell-header {
  background: rgba(255, 221, 87, 0.08);
}


/* подсветка */
.cell.nominated {
    border-color: #b55454;;
    box-shadow: 0 0 0 1px rgba(220,38,38,.35) inset;
}

.cell.nominated .cell-header {
    background: rgb(177 56 56 / 75%);
    color: #fff;
    }


/* бейдж внизу справа */
.vote-badge {
  position: absolute;
  right: 10px; bottom: 10px;
  padding: 6px 10px;
  font-size: 12px; font-weight: 700; letter-spacing: .3px;
  background: rgb(177 56 56 / 75%);
  color:#fff;
  border-radius: 8px;
  display: none;   /* по умолчанию скрыт */
  z-index: 2;
}
.cell.nominated .vote-badge { display: inline-block; }



/* Общий бейдж и три состояния */
.badge {
  position: absolute; right: 10px; bottom: 10px;
  padding: 6px 10px; font-size: 12px; font-weight: 700;
  border-radius: 8px; display: none; z-index: 2; letter-spacing: .3px;
}
.cell.is-vote .badge     { display: inline-block; background: rgba(220,38,38,.9); color:#fff; }   /* ВЫСТАВЛЕН */
.cell.is-expelled .badge { display: inline-block; background: rgba(234,179,8,.95); color:#111; }  /* ВЫГНАН */
.cell.is-killed .badge   { display: inline-block; background: rgba(59,130,246,.95); color:#fff; } /* УБИТ */

.cell.is-vote     { border-color: rgba(220,38,38,.85); box-shadow: 0 0 0 1px rgba(220,38,38,.35) inset; }
.cell.is-expelled { box-shadow: 0 0 0 1px rgba(234,179,8,.35) inset; }
.cell.is-killed   { box-shadow: 0 0 0 1px rgba(59,130,246,.35) inset; }

.cell.is-vote .cell-header     { background: rgba(220,38,38,.75); color: #fff; }
.cell.is-expelled .cell-header { background: rgba(234,179,8,.25); }
.cell.is-killed .cell-header   { background: rgba(59,130,246,.25); }

/* Простое контекст-меню ведущего */
.host-menu {
  position: fixed; background: #111a2e; color: #e5e7eb;
  border: 1px solid rgba(255,255,255,.12); border-radius: 10px;
  box-shadow: 0 8px 24px rgba(0,0,0,.35); padding: 6px; z-index: 50;
}
.host-menu button {
  width: 100%; text-align: left; padding: 8px 10px; border: none; background: none; color: inherit;
  border-radius: 8px; cursor: pointer;
}
.host-menu button:hover { background: rgba(255,255,255,.06); }



/* Шторка */
.curtain {
  position: absolute;
  inset: 0;
  transform: translateX(100%);               /* спрятана справа */
  transition: transform .8s cubic-bezier(.22,1,.36,1);
  pointer-events: none;
  overflow: hidden;
  border-radius: 14px;
  z-index: 3;                                 /* над <video> */
  display: flex; align-items: flex-end; justify-content: space-between;
  padding: 10px;
}

.curtain-text {
  margin-left: auto;
  padding: 6px 10px;
  font-size: 12px; font-weight: 800; letter-spacing: .3px;
  border-radius: 8px;
  background: rgba(0,0,0,.35); color: #fff;
}

/* Цвета и включение анимации */
.cell.is-expelled .curtain {
    transform: translateX(0);
}


.fx-video {
  position: absolute; inset: 0;
  width: 100%; height: 100%;
  object-fit: cover;                           /* полностью закрывает */
  display: none;                               /* включаем из JS */
}


.cell.is-killed .curtain {
  background: linear-gradient(180deg, rgba(59,130,246,.85) 0%, rgba(37,99,235,.95) 100%);
  transform: translateY(0);
}

/* Доп.эффект видео под шторкой */
.cell.is-expelled video,
.cell.is-killed   video {
  filter: grayscale(.5) brightness(.7);
  transition: filter .45s ease;
}


/* ====== ФОН ====== */
.bg{
  position: fixed; inset:0;
  z-index:0;
  pointer-events:none;
  overflow:hidden; /* чтобы ничего не торчало за края */
}

/* небо — градиент: днём светлый, ночью тёмный */
.bg-sky{
  position:absolute; inset:0;
  background: linear-gradient(180deg, #0b1220 0%, #0b1220 100%);
  transition: background 1s ease;
}

/* звёзды — два слоя «блеска» */
.bg-stars, .bg-stars::after{
  content:""; position:absolute; inset:0;
  background-image:
    radial-gradient(2px 2px at 20% 30%, rgba(255,255,255,.9) 50%, transparent 51%),
    radial-gradient(2px 2px at 60% 60%, rgba(255,255,255,.8) 50%, transparent 51%),
    radial-gradient(1.5px 1.5px at 80% 20%, rgba(255,255,255,.7) 50%, transparent 51%),
    radial-gradient(1.5px 1.5px at 35% 75%, rgba(255,255,255,.8) 50%, transparent 51%),
    radial-gradient(1px 1px at 10% 80%, rgba(255,255,255,.7) 50%, transparent 51%),
    radial-gradient(1px 1px at 90% 40%, rgba(255,255,255,.7) 50%, transparent 51%);
  opacity:.0;
  transform: translateZ(0);
  animation: starsTwinkle 6s ease-in-out infinite;
  transition: opacity .8s ease;
}
.bg-stars::after{
  animation-duration: 7.5s;
  filter: blur(.4px); opacity: .0;
}

/* луна */
.bg-moon{
  position:absolute; top:7%; left:8%;
  width:120px; height:120px; border-radius:50%;
  background: radial-gradient(circle at 35% 35%, #fff 0%, #f4f4f4 40%, #d9d9d9 60%, #bfbfbf 100%);
  box-shadow: 0 0 30px 8px rgba(255,255,255,.25), 0 0 80px 18px rgba(180,200,255,.18);
  transform: translateY(-20px);
  opacity:0;
  transition: opacity .8s ease, transform .8s ease;
}

/* озеро — затемнённая полоса снизу с анимированной рябью */
.bg-lake{
  position:absolute; left:0; right:0; bottom:-10%;
  height:45%;
  background: linear-gradient(to bottom, rgba(0, 0, 0, .0), rgb(1 5 107 / 35%) 65%, rgb(12 15 157 / 55%)), repeating-linear-gradient(180deg, rgb(0 0 0 / 6%) 0px, rgb(0 0 0 / 6%) 2px, rgba(255, 255, 255, 0) 3px, rgba(255, 255, 255, 0) 8px);
  filter: blur(.2px);
  opacity:.0;
  animation: lakeMove 12s linear infinite;
  transition: opacity .8s ease;
}

/* фаза ДЕНЬ по умолчанию */
body.phase-day .bg-sky{
  background: radial-gradient(#cd771e, transparent);
}
body.phase-day .bg-stars,
body.phase-day .bg-stars::after,
body.phase-day .bg-moon,
body.phase-day .bg-lake { opacity:0; }

/* фаза НОЧЬ */
body.phase-night .bg-sky{
  background: radial-gradient(#030537, transparent);

}


body.phase-night .bg-stars,
body.phase-night .bg-stars::after{ opacity:.75; }
body.phase-night .bg-moon{ opacity:1; transform: translateY(0); }
body.phase-night .bg-lake{ opacity:.9; }

/* анимации */
@keyframes starsTwinkle {
  0%, 100% { opacity:.55; }
  50%      { opacity:.85; }
}
@keyframes lakeMove {
  0%   { background-position: 0 0, 0 0; }
  100% { background-position: 0 0, 0 24px; }
}

/* чтобы фон не перекрывал сетку: сетка выше фона */
.grid { position:relative; z-index:1; }
.controls { position:relative; z-index:2; }


/* ===== СОЛНЦЕ ===== */
.bg-sun{
  position:absolute;
   top:7%;
   right:1%;
  width:140px; height:140px; border-radius:50%;
  background: radial-gradient(circle at 40% 40%,
              #fff6a5 0%, #ffd85e 45%, #ffb42e 70%, #ff9f1c 100%);
  box-shadow:
    0 0 30px 10px rgba(255,220,100,.35),
    0 0 90px 30px rgba(255,190,60,.25);
  filter: saturate(1.1);
  transform: translateY(-18px) scale(0.98);
  opacity:0;
  transition: opacity .8s ease, transform .8s ease, filter .8s ease;
  animation: sunFloat 10s ease-in-out infinite;
}

@keyframes sunFloat{
  0%,100% { transform: translateY(-18px) scale(0.98); }
  50%     { transform: translateY(0)      scale(1.00); }
}

/* ПОКАЗ/СКРЫТИЕ ПО ФАЗАМ */
body.phase-day  .bg-sun  { opacity:1; }
body.phase-night .bg-sun { opacity:0; }

body.phase-day  .bg-moon { opacity:0; transform: translateY(-20px); }  /* на всякий случай скрываем луну днём */


.timer{
  display:inline-block;
  min-width:150px;
  padding:6px 10px;
  margin-left:10px;
  text-align:center;
  font-weight:800;
  letter-spacing:.5px;
  border-radius:10px;
  background:rgba(255,255,255,.06);
  border:1px solid rgba(255,255,255,.12);
}
.timer.running{
  background:rgba(34,211,238,.12);
  border-color:rgba(34,211,238,.4);
}
.timer.ended{
  background:rgba(220,38,38,.18);
  border-color:rgba(220,38,38,.5);
}





/* ===== ГЛОБАЛЬНЫЙ АНОНС ===== */
.global-annc{
  position: fixed; inset: 0; pointer-events: none;
  display: none; align-items: center; justify-content: center;
  z-index: 80;
  background: radial-gradient(ellipse at center, rgba(0,0,0,.45), rgba(0,0,0,.6));
  animation: gaFade .35s ease both;
  z-index: 10;
}
@keyframes gaFade{ from{ opacity:0 } to{ opacity:1 } }

.global-annc .card{
  position: relative;
  z-index: 10;
  min-width: 520px; max-width: 80vw;
  padding: 22px 26px;
  border-radius: 16px;
  color:#fff; text-align:center; font-weight:900; font-size:26px; letter-spacing:.6px;
  box-shadow: 0 12px 40px rgba(0,0,0,.45), inset 0 0 0 1px rgba(255,255,255,.15);
  transform: scale(.95);
  animation: popIn .25s cubic-bezier(.2,.8,.2,1) .1s both;
}
@keyframes popIn{ to { transform: scale(1) } }

.global-annc .sub{
  display:block; margin-top:6px; font-size:16px; font-weight:700; opacity:.9; z-index: 10;
}

/* Цветовые темы */
.annc-doc   {
    background: linear-gradient(135deg,#0ea5b7,#22d3ee);
    z-index: 10;
}

.annc-cop   {
    background: linear-gradient(135deg,#6d28d9,#a78bfa);
    z-index: 10;
}


.annc-town  {
    background: linear-gradient(135deg,#0f766e,#22c55e);
    z-index: 10;
}

.annc-mafia {
    background: linear-gradient(135deg,#7f1d1d,#ef4444);
    z-index: 10;
}

/* Лучи/блики */
.global-annc .card::before{
  content:""; position:absolute; inset:-2px; border-radius:18px;
  background: conic-gradient(from 0deg, rgba(255,255,255,.15), transparent 30%, transparent 70%, rgba(255,255,255,.15));
  filter: blur(10px); opacity:.65; mix-blend-mode: screen;
  animation: spin 3.5s linear infinite;
}
@keyframes spin{ to{ transform: rotate(360deg) } }

/* Партиклы (простая конфетти-анимация) */
.confetti-piece{
  position:absolute; width:10px; height:14px; opacity:.9; transform: rotate(0deg);
  animation: fall 1.4s linear forwards, sway .9s ease-in-out infinite alternate;
}
@keyframes fall{ to{ transform: translateY(420px) rotate(260deg) } }
@keyframes sway{ from{ margin-left: -6px } to{ margin-left: 6px } }
